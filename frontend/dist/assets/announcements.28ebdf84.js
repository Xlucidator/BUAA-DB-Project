import{d as X,b as _,v as C,x as Y,e as h,g as l,w as o,f as u,i as a,j as N,F as v,I as Z,A as F,a as s,h as ee,o as p,k as w,t as I,c as L,y as r,z as U,J as te,_ as le}from"./index.620621f6.js";import{N as m}from"./utils.f640e782.js";const oe={class:"block"},ae={class:"text-xl font-extrabold"},ne={style:{color:"#888888"}},se={style:{color:"#888888"}},ue={style:{color:"#888888"}},de={class:"text-xl font-extrabold"},ie={style:{color:"#888888"}},re={style:{color:"#888888"}},ce={style:{color:"#888888"}},me={class:"editor"},pe={class:"dialog-footer"},_e=X({__name:"announcements",props:{modelValue:null,height:{default:"700px"},width:{default:"500px"},placeholder:{default:"\u8BF7\u8F93\u5165\u5185\u5BB9"}},emits:["update:modelValue"],setup(P,{emit:z}){const S=P,O=ee(),g=_(1);let f=_(C.state.passageList),b=5;const k=_(C.state.totalPageNum*b);let c=_(0);console.log("currentPageNum",g.value),console.log("totalPageNum",k);const j=()=>{O.go(-1)},T=n=>{console.log("changePage ",g.value,n),Z(F(),n).then(e=>{console.log("getCurrentPage ",e),e.status!==200?"details"in e.data?m(0,e.data.details):m(0,"ops~! other error"):(m(1,"success"),k.value=e.data.totalPage*b,f.value=e.data.pageObj,g.value=n,c.value=1-c.value)}).catch(e=>{console.log("getCurrentPage err ",e),m(0,e.detail)})};let i=_(!1),d=_({Title:"",Poster:"",Content:"",LastEditor:"",Type:""});d.value.Poster=C.state.user.CodeName,d.value.LastEditor=C.state.user.CodeName,Y({get(){return S.modelValue},set(n){z("update:modelValue",n)}});const R=(n,e)=>{console.log(e)},G=()=>{te(F(),d).then(n=>{console.log("newPost ",n),console.log("newPost ",d),n.status!==201?"details"in n.data?m(0,n.data.details):m(0,"ops~! other error"):(m(1,n.data),i.value=!1,console.log(c.value),c.value=1-c.value,T(1),console.log(c.value))}).catch(n=>{console.log("newPost err ",n),m(0,n.detail)})};return(n,e)=>{const J=s("ArrowLeft"),B=s("el-icon"),y=s("el-button"),K=s("Edit"),$=s("el-row"),A=s("router-link"),E=s("el-card"),D=s("el-timeline-item"),q=s("el-timeline"),H=s("el-pagination"),x=s("el-input"),V=s("el-form-item"),M=s("v-md-editor"),Q=s("el-form"),W=s("el-dialog");return p(),h(v,null,[l($,{class:"mb-4",style:{"margin-top":"3%"}},{default:o(()=>[l(y,{onClick:j,style:{"margin-left":"5%"}},{default:o(()=>[l(B,null,{default:o(()=>[l(J)]),_:1}),w(" back ")]),_:1}),l(y,{onClick:e[0]||(e[0]=t=>N(i)?i.value=!0:i=!0),type:"primary",style:{"margin-left":"74%"},size:"large",plain:""},{default:o(()=>[l(B,null,{default:o(()=>[l(K)]),_:1}),w(" New Post ")]),_:1})]),_:1}),u("div",null,[u("div",oe,[l(q,null,{default:o(()=>[a(c)===0?(p(),h(v,{key:0},[(p(!0),h(v,null,I(a(f),t=>(p(),L(D,{timestamp:t.PostDate,placement:"top"},{default:o(()=>[l(E,null,{default:o(()=>[l(A,{to:"bulletin/singlePage/"+t.PId},{default:o(()=>[u("p",ae,r(t.Title),1)]),_:2},1032,["to"]),u("p",ne,"author: "+r(t.Poster),1),u("p",se,"date: "+r(t.PostDate),1),u("p",ue,"type: "+r(t.Type),1)]),_:2},1024)]),_:2},1032,["timestamp"]))),256)),u("p",null,r(a(f).value),1)],64)):U("",!0),a(c)===1?(p(),h(v,{key:1},[(p(!0),h(v,null,I(a(f),t=>(p(),L(D,{timestamp:t.PostDate,placement:"top"},{default:o(()=>[l(E,null,{default:o(()=>[l(A,{to:"bulletin/singlePage/"+t.PId},{default:o(()=>[u("p",de,r(t.Title),1)]),_:2},1032,["to"]),u("p",ie,"author: "+r(t.Poster),1),u("p",re,"date: "+r(t.PostDate),1),u("p",ce,"type: "+r(t.Type),1)]),_:2},1024)]),_:2},1032,["timestamp"]))),256)),u("p",null,r(a(f).value),1)],64)):U("",!0)]),_:1})]),l(H,{class:"mpage",background:"",layout:"prev, pager, next","current-page":g.value,"onUpdate:current-page":e[1]||(e[1]=t=>g.value=t),"page-size":a(b),total:k.value,onCurrentChange:T},null,8,["current-page","page-size","total"])]),l(W,{width:"90%",modelValue:a(i),"onUpdate:modelValue":e[7]||(e[7]=t=>N(i)?i.value=t:i=t),title:"EDIT PASSAGE"},{footer:o(()=>[u("span",pe,[l(y,{onClick:e[6]||(e[6]=t=>N(i)?i.value=!1:i=!1)},{default:o(()=>[w("Cancel")]),_:1}),l(y,{type:"primary",onClick:G},{default:o(()=>[w("Confirm")]),_:1})])]),default:o(()=>[l(Q,{model:a(d)},{default:o(()=>[l(V,{label:"title","label-width":60},{default:o(()=>[l(x,{modelValue:a(d).Title,"onUpdate:modelValue":e[2]||(e[2]=t=>a(d).Title=t)},null,8,["modelValue"])]),_:1}),l(V,{label:"author","label-width":60},{default:o(()=>[l(x,{modelValue:a(d).Poster,"onUpdate:modelValue":e[3]||(e[3]=t=>a(d).Poster=t),disabled:""},null,8,["modelValue"])]),_:1}),l(V,{label:"type","label-width":60},{default:o(()=>[l(x,{modelValue:a(d).Type,"onUpdate:modelValue":e[4]||(e[4]=t=>a(d).Type=t)},null,8,["modelValue"])]),_:1}),l(V,{label:"content","label-width":60},{default:o(()=>[u("div",me,[l(M,{placeholder:P.placeholder,"disabled-menus":[],modelValue:a(d).Content,"onUpdate:modelValue":e[5]||(e[5]=t=>a(d).Content=t),height:P.height,width:P.width,onChange:R},null,8,["placeholder","modelValue","height","width"])])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"])],64)}}});const he=le(_e,[["__scopeId","data-v-b3964960"]]);export{he as default};
